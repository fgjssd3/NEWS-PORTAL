{% load static %}
{% block body %}

<!doctype html>
<html lang="en">
<head>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
 
  <title>News Portal | Search</title>
 <link rel="icon" type="image/png" href="{% static 'images/logo2.png' %}">
  <!-- Bootstrap 5 + FA6 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet"/>

  <style>
    :root{ --ink:#0f172a; --muted:#64748b; --primary:#0ea5e9; --primary-2:#0369a1; }
    body{ background:#f8fafc; color:var(--ink); }
    .article-card{ border:0; border-radius:1rem; box-shadow:0 10px 28px rgba(15,23,42,.12); overflow:hidden; }
    .article-card .thumb{ width:100%; height:220px; object-fit:cover; background:#e2e8f0; }
    .meta{ color:var(--muted); }
    .badge-cat{ background:#e0f2fe; color:#075985; border:1px solid #bae6fd; }
    .chip{ background:#eef2ff; color:#3730a3; border:1px solid #c7d2fe; border-radius:999px; padding:.25rem .6rem; }
    .with-gap{ gap: .5rem .75rem; }
    .result-title mark{ padding:.1em .2em; border-radius:.2rem; }
  </style>
</head>
<body>

  {% include 'header.html' %}

  <div class="container py-4 py-lg-5">
    <div class="row g-4">
      <!-- Results -->
      <div class="col-lg-8">
        <div class="d-flex align-items-center justify-content-between flex-wrap with-gap mb-3">
          <div class="d-flex align-items-center with-gap">
            <h1 class="h5 mb-0" style="color:var(--primary-2)">
              <i class="fa-solid fa-magnifying-glass me-2"></i> Search Results
            </h1>
            {% if request.GET.q %}
              <span class="chip">‚Äú{{ request.GET.q }}‚Äù</span>
            {% endif %}
          </div>
          <span class="meta">{{ newspost|length }} result{{ newspost|length|pluralize }}</span>
        </div>

        {% if newspost %}
          {% for i in newspost %}
            <div class="card article-card mb-4">
              {% if i.postimage %}
                <img class="thumb" src="{{ i.postimage.url }}" alt="{{ i.posttitle }}">
              {% else %}
                <img class="thumb" src="{% static 'images/placeholder-16x9.png' %}" alt="No image">
              {% endif %}
              <div class="card-body">
                <h2 class="h5 result-title mb-2">{{ i.posttitle }}</h2>

                <div class="d-flex align-items-center meta flex-wrap with-gap mb-3">
                  <span class="badge badge-cat">
                    <i class="fa-solid fa-tag me-1"></i>
                    <a class="text-decoration-none" href="{% url 'categorynews' i.category.id %}">{{ i.category.categoryname }}</a>
                  </span>
                  <span><i class="fa-regular fa-calendar-days me-1"></i>{{ i.postdate }}</span>
                </div>

                <a href="{% url 'news_detail' i.id %}" class="btn btn-primary">
                  <i class="fa-regular fa-newspaper me-1"></i> Read More
                </a>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <!-- Empty state -->
          <div class="text-center py-5">
            <div class="display-6 mb-2">üòï</div>
            <h5 class="mb-2">No results found</h5>
            <p class="meta">Try different keywords or check your spelling.</p>
          </div>
        {% endif %}
      </div>

      <!-- Sidebar -->
      {% include 'sidebaruser.html' %}
    </div>
  </div>

  {% include 'footer.html' %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Optional: highlight the searched term inside titles (simple client-side) -->
  <script>
    (function(){
      const q = {{ request.GET.q|default_if_none:""|escapejs|safe }};
      if(!q) return;
      const term = q.trim();
      if(!term) return;

      const rx = new RegExp("(" + term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + ")", "ig");
      document.querySelectorAll('.result-title').forEach(el=>{
        el.innerHTML = el.textContent.replace(rx, '<mark>$1</mark>');
      });
    })();
  </script>
</body>
</html>

{% endblock %}
